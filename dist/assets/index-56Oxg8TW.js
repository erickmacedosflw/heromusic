const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BandHub-Df2taMJs.js","assets/palcos-B0Yrewnb.js","assets/vendor-react-Jel5_CP7.js","assets/vendor-icons-BtnucH8e.js","assets/vendor-motion-B1NRm1cq.js","assets/vendor-y2JGIE03.js","assets/vendor-BD3kB6ic.css","assets/vendor-audio--cOFEis5.js","assets/BandGame-m_knVGP-.js","assets/vendor-three-core-DT6N9nxM.js","assets/vendor-three-extras-DD61c-0z.js","assets/BandGame-BxvQfwHQ.css"])))=>i.map(i=>d[i]);
import{r as l,R as B,j as f,a as Z}from"./vendor-react-Jel5_CP7.js";import{X as K,Y as _}from"./vendor-y2JGIE03.js";import{h as d}from"./vendor-audio--cOFEis5.js";(function(){const V=document.createElement("link").relList;if(V&&V.supports&&V.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))A(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&A(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function A(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();const J="modulepreload",j=function(t){return"/"+t},U={},b=function(V,e,A){let n=Promise.resolve();if(e&&e.length>0){let c=function(a){return Promise.all(a.map(q=>Promise.resolve(q).then(s=>({status:"fulfilled",value:s}),s=>({status:"rejected",reason:s}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=r?.nonce||r?.getAttribute("nonce");n=c(e.map(a=>{if(a=j(a),a in U)return;U[a]=!0;const q=a.endsWith(".css"),s=q?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${s}`))return;const u=document.createElement("link");if(u.rel=q?"stylesheet":J,q||(u.as="script"),u.crossOrigin="",u.href=a,i&&u.setAttribute("nonce",i),document.head.appendChild(u),q)return new Promise((p,Q)=>{u.addEventListener("load",p),u.addEventListener("error",()=>Q(new Error(`Unable to preload CSS for ${a}`)))})}))}function o(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return n.then(r=>{for(const i of r||[])i.status==="rejected"&&o(i.reason);return V().catch(o)})},z=()=>({guitar:{hired:!1,musicianId:null,skillLevel:1,instrumentLevel:1},drums:{hired:!1,musicianId:null,skillLevel:1,instrumentLevel:1},bass:{hired:!1,musicianId:null,skillLevel:1,instrumentLevel:1},keys:{hired:!1,musicianId:null,skillLevel:1,instrumentLevel:1}}),C=()=>({isCreating:!1,step:"welcome",selectedLogoUrl:null,draftName:""}),P=()=>({musicEnabled:!0,sfxEnabled:!0,instrumentVolumes:{guitar:1,drums:1,bass:1,keys:1}}),H=t=>{const V=t.unlockedMusicianIds??[],e=Object.values(t.musicians).map(A=>A.musicianId).filter(A=>A!==null);return Array.from(new Set([...V,...e]))},w=K()(_((t,V)=>({isLoaded:!1,bands:[],activeBandId:null,currentStageId:1,creation:C(),audioSettings:P(),cameraMotionEnabled:!0,showPerformance:!1,score:0,combo:0,lastHit:null,setLoaded:e=>t({isLoaded:e}),startBandCreation:()=>t({creation:{isCreating:!0,step:"welcome",selectedLogoUrl:null,draftName:""}}),cancelBandCreation:()=>t({creation:C()}),setCreationStep:e=>t(A=>({creation:{...A.creation,isCreating:!0,step:e}})),setCreationLogo:e=>t(A=>({creation:{...A.creation,selectedLogoUrl:e}})),setCreationName:e=>t(A=>({creation:{...A.creation,draftName:e}})),setMusicEnabled:e=>t(A=>({audioSettings:{...A.audioSettings,musicEnabled:e}})),setSfxEnabled:e=>t(A=>({audioSettings:{...A.audioSettings,sfxEnabled:e}})),setCameraMotionEnabled:e=>t({cameraMotionEnabled:e}),setInstrumentVolume:(e,A)=>t(n=>({audioSettings:{...n.audioSettings,instrumentVolumes:{...n.audioSettings.instrumentVolumes,[e]:Math.max(0,Math.min(1,Number.isFinite(A)?A:1))}}})),createBandFromDraft:()=>{const{creation:e}=V(),A=e.draftName.trim();if(!A||!e.selectedLogoUrl)return;const n={id:`band-${Date.now()}`,name:A,logoUrl:e.selectedLogoUrl,createdAt:Date.now(),coins:2e3,fans:0,reputation:0,fameStars:0,musicians:z(),unlockedMusicianIds:[],autoplayUnlocked:!1};t(o=>({bands:[...o.bands,n],activeBandId:n.id,currentStageId:1,creation:C(),showPerformance:!1,score:0,combo:0,lastHit:null}))},selectBand:e=>t({activeBandId:e,showPerformance:!1}),setCurrentStage:e=>t({currentStageId:e}),deleteBand:e=>t(A=>{const n=A.bands.filter(r=>r.id!==e),o=A.activeBandId===e?n[0]?.id??null:A.activeBandId;return{bands:n,activeBandId:o,showPerformance:!1}}),openPerformance:()=>t({showPerformance:!0,score:0,combo:0,lastHit:null}),closePerformance:()=>t({showPerformance:!1}),tapBeat:(e,A)=>t(n=>{if(!n.activeBandId)return n;const o=n.bands.find(m=>m.id===n.activeBandId);if(!o)return n;const r=Object.values(o.musicians).filter(m=>m.hired).length,i={perfect:12,good:6,miss:0},c={perfect:3,good:1,miss:0},a=e==="miss"?0:n.combo+1,q=Math.max(1,r),s=(i[e]+A)*q,u=c[e]*q,p=e==="miss"?0:2+r;return{bands:n.bands.map(m=>m.id!==n.activeBandId?m:{...m,fans:m.fans+u,coins:m.coins+p,reputation:m.reputation+(e==="perfect"?2:e==="good"?1:0),autoplayUnlocked:m.autoplayUnlocked||m.fans>=300}),score:n.score+s,combo:a,lastHit:e}}),applyShowRewards:(e,A,n)=>t(o=>o.activeBandId?{bands:o.bands.map(i=>i.id!==o.activeBandId?i:{...i,fans:i.fans+Math.max(0,e),reputation:i.reputation+Math.max(0,A),coins:i.coins+Math.max(0,n)})}:o),addFameStars:e=>t(A=>{if(!A.activeBandId)return A;const n=Math.max(0,Math.floor(e));return n<=0?A:{bands:A.bands.map(r=>r.id!==A.activeBandId?r:{...r,fameStars:Math.max(0,Math.floor(r.fameStars??0))+n})}}),hireMusician:(e,A,n)=>t(o=>{if(!o.activeBandId)return o;const r=Math.max(0,Math.floor(A??120));return{bands:o.bands.map(c=>{if(c.id!==o.activeBandId)return c;const a=c.musicians[e],q=H(c),s=n??a.musicianId??null;return a.hired&&a.musicianId===s||s===null||q.includes(s)||c.coins<r?c:{...c,coins:c.coins-r,unlockedMusicianIds:[...q,s],musicians:{...c.musicians,[e]:{...a,hired:!0,musicianId:s}}}})}}),setBandMusicianSelection:(e,A)=>t(n=>n.activeBandId?{bands:n.bands.map(r=>{if(r.id!==n.activeBandId)return r;const i=r.musicians[e],c=H(r),a=A??null;return a!==null&&!c.includes(a)||i.musicianId===a&&i.hired===(a!==null)?r:{...r,unlockedMusicianIds:c,musicians:{...r.musicians,[e]:{...i,hired:a!==null,musicianId:a}}}})}:n),upgradeInstrument:e=>t(A=>A.activeBandId?{bands:A.bands.map(o=>{if(o.id!==A.activeBandId)return o;const r=o.musicians[e],i=60+r.instrumentLevel*40;return!r.hired||o.coins<i?o:{...o,coins:o.coins-i,musicians:{...o.musicians,[e]:{...r,instrumentLevel:r.instrumentLevel+1,skillLevel:r.skillLevel+1}}}})}:A)}),{name:"hero-music-save-v1",version:3,migrate:t=>{if(!t||typeof t!="object")return t;const V=t,e=P(),A=V.audioSettings?.instrumentVolumes??{},n={musicEnabled:V.audioSettings?.musicEnabled??e.musicEnabled,sfxEnabled:V.audioSettings?.sfxEnabled??e.sfxEnabled,instrumentVolumes:{guitar:Math.max(0,Math.min(1,A.guitar??e.instrumentVolumes.guitar)),drums:Math.max(0,Math.min(1,A.drums??e.instrumentVolumes.drums)),bass:Math.max(0,Math.min(1,A.bass??e.instrumentVolumes.bass)),keys:Math.max(0,Math.min(1,A.keys??e.instrumentVolumes.keys))}};return Array.isArray(V.bands)?{...V,audioSettings:n,bands:V.bands.map(o=>({...o,fameStars:Math.max(0,Math.floor(o.fameStars??0))}))}:{...V,audioSettings:n}},partialize:t=>({bands:t.bands.map(V=>({...V,fameStars:Math.max(0,Math.floor(V.fameStars??0))})),activeBandId:t.activeBandId,currentStageId:t.currentStageId,audioSettings:t.audioSettings})})),X=({onLoadComplete:t})=>{const V=w(e=>e.setLoaded);return l.useEffect(()=>{const e=setTimeout(()=>{V(!0),t()},400);return()=>clearTimeout(e)},[t,V]),B.createElement("div",{className:"boot-scene"},"Loading assets...")},$=(t=()=>{})=>{const V=l.useRef(null),e=l.useRef(0),A=n=>{if(e.current!==0){const o=n-e.current;t(o)}e.current=n,V.current=requestAnimationFrame(A)};return l.useEffect(()=>(V.current=requestAnimationFrame(A),()=>{V.current!==null&&cancelAnimationFrame(V.current)}),[]),null},ee=new URL("data:audio/mpeg;base64,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",import.meta.url).href,ne=new URL("data:audio/mpeg;base64,SUQzBAAAAAACIlRFTkMAAAANAAADTG9naWMgUHJvIFgAVERSQwAAAAwAAAMyMDIxLTA5LTI3AFRYWFgAAAEJAAADdW1pZAAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEY4MDA2Q0JBAFRYWFgAAAARAAADY29kaW5nX2hpc3RvcnkAAFRYWFgAAAAaAAADdGltZV9yZWZlcmVuY2UAMTU4NzYwMDAwAFRTU0UAAAAPAAADTGF2ZjU5LjI3LjEwMAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAFtgA/Pz8/Pz8/Pz8/Pz9bW1tbW1tbW1tbW1t2dnZ2dnZ2dnZ2dnZ2kpKSkpKSkpKSkpKSra2tra2tra2tra2trcnJycnJycnJycnJyeTk5OTk5OTk5OTk5OT///////////////8AAAAATGF2YzU5LjM3AAAAAAAAAAAAAAAAJALAAAAAAAAABbaNDQcBAAAAAAAAAAAAAAAAAAAAAP/7MGQAAAD1BzOFJEACCYAXKKAEAQXgcSQZ04AIYYSmFyAgAJznRAFAQEiYIAgKEEAAADw8PDwwAAAAADw8PDwwAEAQOAAHOA+B3g//pCgwRgaF5iUOH+Y0BgZTDQbO9+ZYFz/hwWtnQ7ML2cdKeQUBYPX+TzBtf7eNYYABAAAGkYkOHLyfDlwFoNXZtRJiHwJnwSXAAkQAJiAPCf/7MmQEA3FkE03HcOAIEMFqZOQIAQVAJPgOf4RgQwLcQdB4TNCbFIdVRCAKSgExlbTuZYEi8qFdUVkUZqQaH5XyoTFP4n9R6RQmAdwiz3qpDgBWW6/GAONlTO0POHHfzUllK7IdlUpgnQUoYb2Lcmg0MBJnkZGQVqM7KpDbzf//81IpSxxx8fxxXx/liik6KaKCt8sDAgKY6n24sqL/+zJkBIkxLA2zKeETlBOA9igYKRME7DqSDATQAECDU1TwPEQLEAHRBwlKHZne4lghW0whiLtfLEf4CIu/Lf0BVVPEAAAMDoE0IDIaBkNEyJqkRZbcpnbaGKmraFngyQhElGmamNK4dmJOtFUzXoetZMFLV/K/60f/+EnaAD+FKL6cJ+lkDaOAL4pmVTMrDwYWTEFNRTMuMTAwVVVV//syZAiP8BAAgAMgAAgBYBAAPAABABACAACAACAEgEAAkAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVTEFNRTMuMTAwVVVVVVVVVVVVVVVVVVVVVVVVVf/7MGRCj/AAAAAAAAAIAAAAAAAAAQAAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7MmR+j/AAAGkAAAAIAAANIAAAAQAAAaQAAAAgAAA0gAAABFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVX/+zJkuw/wAABpAAAACAAADSAAAAEAAAGkAAAAIAAANIAAAARVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//syZMMP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==",import.meta.url).href,te=new URL("/assets/Clique_confirm-BwGJ6X4F.mp3",import.meta.url).href,Ae=new URL("/assets/Clique_cancelar-BrqNkGb4.mp3",import.meta.url).href,Ve=["button","a","input","select","textarea","label",'[role="button"]','[role="menuitem"]','[data-click-interactive="true"]'].join(","),oe=t=>t==="confirm"?"confirm":t==="cancel"?"cancel":t==="close"?"close":t==="open"?"open":"default",re=new d.Howl({src:[ee],preload:!0,volume:1,html5:!1,pool:1}),ie=new d.Howl({src:[ne],preload:!0,volume:1,html5:!1,pool:1}),se=new d.Howl({src:[te],preload:!0,volume:1,html5:!1,pool:1}),qe=new d.Howl({src:[Ae],preload:!0,volume:1,html5:!1,pool:1});let h=null,M=null;const N=()=>{typeof window>"u"||(d.Howler.autoSuspend=!1,d.Howler.ctx?.resume())},O=()=>{!h||M===null||(h.stop(M),h=null,M=null)},Y=(t="default")=>{if(typeof window>"u"||!w.getState().audioSettings.sfxEnabled)return;N();const V=()=>{O();const A=t==="close"?ie:t==="confirm"?se:t==="cancel"?qe:re,n=A.play();typeof n=="number"&&(h=A,M=n,A.once("end",o=>{o===M&&(h=null,M=null)},n))},e=d.Howler.ctx;if(e&&e.state!=="running"){e.resume().then(V).catch(V);return}V()};let g=null;const ae=()=>{if(typeof document>"u")return()=>{};if(g)return g;N();const t=V=>{const e=V.target;if(!(e instanceof Element)||e.closest('[data-click-sfx-ignore="true"]'))return;const A=e.closest("[data-click-sfx]");if(A){Y(oe(A.dataset.clickSfx));return}const n=!!e.closest(".stage-screen"),o=!!e.closest(Ve);n&&!o||o&&Y("default")};return document.addEventListener("pointerdown",t,!0),g=()=>{document.removeEventListener("pointerdown",t,!0),O(),g=null},g},ce=new URL("/assets/Musica_Tema-CEONEEWO.mp3",import.meta.url).href,ue=new URL("/assets/Music_background_mapa-C53oXAh3.mp3",import.meta.url).href,y=["menu","map"],T=.25,le=900,G=520,de=.2,me=.8,I={};let L=!1,E=null,v=null,k=null;const fe=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent),R=fe,x={menu:new d.Howl({src:[ce],preload:!0,loop:!0,volume:0,html5:R,pool:1}),map:new d.Howl({src:[ue],preload:!0,loop:!0,volume:0,html5:R,pool:1})},F=t=>{const V=I[t];typeof window<"u"&&V&&(window.clearTimeout(V),I[t]=void 0)},we=(t,V,e)=>{const A=t.sampleRate,n=Math.max(1,Math.floor(A*V)),o=t.createBuffer(2,n,A);for(let r=0;r<o.numberOfChannels;r+=1){const i=o.getChannelData(r);for(let c=0;c<n;c+=1){const a=c/n,q=Math.pow(1-a,e);i[c]=(Math.random()*2-1)*q}}return o},Me=()=>{if(L||typeof window>"u")return;const t=d.Howler.ctx,V=d.Howler.masterGain;if(!t||!V)return;const e=t.createGain();e.gain.value=me;const A=t.createGain();A.gain.value=de;const n=t.createConvolver();n.buffer=we(t,1.35,2.2),e.connect(V),A.connect(n),n.connect(V),E=e,v=A,k=n,L=!0},pe=t=>{if(R||(Me(),!L||!E||!v||!k))return;(t._sounds??[]).forEach(A=>{const n=A._node;if(!(!n||typeof n.disconnect!="function"||typeof n.connect!="function"))try{n.disconnect(),n.connect(E),n.connect(v)}catch{n.connect(d.Howler.masterGain)}})},ge=()=>{typeof window>"u"||(d.Howler.autoSuspend=!1,d.Howler.ctx?.resume())},S=(t="menu")=>{if(typeof window>"u")return;ge(),F(t),y.forEach(n=>{n!==t&&D(n)});const V=x[t],e=()=>{V.playing()||(V.volume(0),V.play()),pe(V);const n=Number(V.volume())||0;if(n>=T){V.volume(T);return}V.fade(n,T,le)},A=d.Howler.ctx;if(A&&A.state!=="running"){A.resume().then(e).catch(e);return}e()},D=t=>{if(typeof window>"u")return;(t?[t]:y).forEach(e=>{F(e);const A=x[e];if(!A.playing()){A.volume(0);return}const n=Number(A.volume())||0;A.fade(n,0,G),I[e]=window.setTimeout(()=>{A.pause(),A.volume(0),I[e]=void 0},G+40)})},he=(t,V="menu")=>{if(typeof window>"u")return()=>{};const e=()=>{if(t&&!t()){D(V);return}S(V)};return window.addEventListener("pointerdown",e,{once:!0}),window.addEventListener("keydown",e,{once:!0}),()=>{window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",e)}},De=()=>{typeof window<"u"&&y.forEach(F),y.forEach(t=>{const V=x[t];V.stop(),V.unload()}),k?.disconnect(),v?.disconnect(),E?.disconnect(),k=null,v=null,E=null,L=!1},Ee=B.lazy(()=>b(()=>import("./BandHub-Df2taMJs.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),ve=B.lazy(()=>b(()=>import("./BandGame-m_knVGP-.js"),__vite__mapDeps([8,2,7,9,10,1,5,6,11]))),Be=()=>{const[t,V]=l.useState("boot"),e=w(q=>q.isLoaded),A=w(q=>q.activeBandId),n=w(q=>q.audioSettings.musicEnabled),o=w(q=>q.setMusicEnabled),r=l.useRef(t),i=l.useRef(n);l.useEffect(()=>{r.current=t},[t]),l.useEffect(()=>{i.current=n},[n]),l.useEffect(()=>{e&&V("menu")},[e]),$(),l.useEffect(()=>ae(),[]),l.useEffect(()=>{if(t==="menu"&&n)return S("menu"),he(()=>r.current==="menu"&&i.current,"menu");(!n||t!=="menu")&&D("menu")},[t,n]),l.useEffect(()=>{const q=()=>{if(!n){D();return}t==="menu"&&(typeof document<"u"&&document.visibilityState==="hidden"||S("menu"))},s=()=>{document.visibilityState==="visible"&&q()},u=()=>{q()};return document.addEventListener("visibilitychange",s),window.addEventListener("pageshow",u),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("pageshow",u)}},[t,n]),l.useEffect(()=>{const q=()=>{const p=r.current==="menu"&&i.current;if(!(typeof document<"u"&&document.visibilityState==="hidden")){if(p){S("menu");return}i.current||D()}},s=()=>{document.visibilityState==="visible"&&q()},u=()=>{q()};return document.addEventListener("visibilitychange",s),window.addEventListener("pageshow",u),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("pageshow",u)}},[]),l.useEffect(()=>()=>{De()},[]);const c=()=>{o(!n)},a=()=>{switch(t){case"boot":return f.jsx(X,{onLoadComplete:()=>V("menu")});case"menu":return f.jsx(Ee,{onStartGame:()=>V("game"),isMusicEnabled:n,onToggleMusic:c});case"game":return f.jsx(ve,{onBackToMenu:()=>V("menu")});default:return null}};return l.useEffect(()=>{t==="game"&&!A&&V("menu")},[A,t]),f.jsx("div",{className:"game-container",children:f.jsx(B.Suspense,{fallback:f.jsx("div",{className:"boot-scene",children:"Loading assets..."}),children:a()})})};function Se(t={}){const{immediate:V=!1,onNeedRefresh:e,onOfflineReady:A,onRegistered:n,onRegisteredSW:o,onRegisterError:r}=t;let i,c;const a=async(s=!0)=>{await c};async function q(){if("serviceWorker"in navigator){if(i=await b(async()=>{const{Workbox:s}=await import("./vendor-y2JGIE03.js").then(u=>u.Z);return{Workbox:s}},__vite__mapDeps([5,2,6])).then(({Workbox:s})=>new s("/sw.js",{scope:"/",type:"classic"})).catch(s=>{r?.(s)}),!i)return;i.addEventListener("activated",s=>{(s.isUpdate||s.isExternal)&&window.location.reload()}),i.addEventListener("installed",s=>{s.isUpdate||A?.()}),i.register({immediate:V}).then(s=>{o?o("/sw.js",s):n?.(s)}).catch(s=>{r?.(s)})}}return c=q(),a}Se({immediate:!0});const W=document.getElementById("root");if(!W)throw new Error("Root element not found");Z.createRoot(W).render(f.jsx(B.StrictMode,{children:f.jsx(Be,{})}));export{S as a,Y as b,D as p,w as u};
//# sourceMappingURL=index-56Oxg8TW.js.map
